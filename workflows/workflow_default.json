{
  "fileName": "Accounting_Records_v3.json",
  "fileContent": "{\n  \"createdAt\": \"2024-09-24T23:42:48.435Z\",\n  \"updatedAt\": \"2024-11-05T17:14:59.020Z\",\n  \"id\": \"VQbxRZWUO1457UNO\",\n  \"name\": \"Accounting Records v3\",\n  \"active\": false,\n  \"isArchived\": false,\n  \"nodes\": [\n    {\n      \"parameters\": {},\n      \"id\": \"31238a60-30f9-402f-992f-a40f46866daf\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -6253,\n        1660\n      ]\n    },\n    {\n      \"parameters\": {\n        \"conditions\": {\n          \"options\": {\n            \"caseSensitive\": true,\n            \"leftValue\": \"\",\n            \"typeValidation\": \"strict\"\n          },\n          \"conditions\": [\n            {\n              \"id\": \"cb8215b3-b748-49ae-a7cb-1321694fb6bb\",\n              \"leftValue\": \"={{ $json.mimeType }}\",\n              \"rightValue\": \"xml\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"contains\"\n              }\n            }\n          ],\n          \"combinator\": \"and\"\n        },\n        \"options\": {\n          \"ignoreCase\": false\n        }\n      },\n      \"id\": \"9987c823-ba92-4706-a918-599d919b1d8b\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"typeVersion\": 2.1,\n      \"position\": [\n        -4060,\n        1680\n      ]\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"xml\",\n        \"options\": {}\n      },\n      \"id\": \"ad5b4502-50e9-4e64-a064-9c2d27d96808\",\n      \"name\": \"XML Data\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -3660,\n        1580\n      ]\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"download\",\n        \"fileId\": {\n          \"__rl\": true,\n          \"value\": \"={{ $json.id }}\",\n          \"mode\": \"id\"\n        },\n        \"options\": {}\n      },\n      \"id\": \"e61b157e-9949-479b-81f5-378e58ab93e8\",\n      \"name\": \"Get Files / XML\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"typeVersion\": 3,\n      \"position\": [\n        -3860,\n        1580\n      ],\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"wdsP0R2suhB5uk31\",\n          \"name\": \"Google Drive H&F\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"move\",\n        \"fileId\": {\n          \"__rl\": true,\n          \"value\": \"={{ $('List Files').item.json.id }}\",\n          \"mode\": \"id\"\n        },\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\"\n        },\n        \"folderId\": {\n          \"__rl\": true,\n          \"value\": \"1o1Gd60RuWV_BDNGoaElP-FV2z8ERSMkw\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Extracted\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1o1Gd60RuWV_BDNGoaElP-FV2z8ERSMkw\"\n        }\n      },\n      \"id\": \"3c4f9031-a21b-47f6-8176-c2b4ef651e6a\",\n      \"name\": \"Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"typeVersion\": 3,\n      \"position\": [\n        5120,\n        2000\n      ],\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"wdsP0R2suhB5uk31\",\n          \"name\": \"Google Drive H&F\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"tableId\": \"Invoices_n8n\",\n        \"dataToSend\": \"autoMapInputData\"\n      },\n      \"id\": \"eb321d7d-03a0-4b19-9e61-432e838dcc8b\",\n      \"name\": \"InvoiceDB\",\n      \"type\": \"n8n-nodes-base.supabase\",\n      \"typeVersion\": 1,\n      \"position\": [\n        4727,\n        1020\n      ],\n      \"alwaysOutputData\": true,\n      \"credentials\": {\n        \"supabaseApi\": {\n          \"id\": \"U4Lx0acH9rOsOwsN\",\n          \"name\": \"Supabase InvoiceData\"\n        }\n      },\n      \"onError\": \"continueErrorOutput\"\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"getAll\",\n        \"tableId\": \"VendorAccounts\",\n        \"matchType\": \"allFilters\",\n        \"filters\": {\n          \"conditions\": [\n            {\n              \"keyName\": \"ReceiverParty_CompanyID\",\n              \"condition\": \"ilike\",\n              \"keyValue\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_CompanyID }}\"\n            },\n            {\n              \"keyName\": \"SenderParty_CompanyID\",\n              \"condition\": \"like\",\n              \"keyValue\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_CompanyID }}\"\n            }\n          ]\n        }\n      },\n      \"id\": \"a83365c7-5c9f-48ad-b26c-688b2971e17c\",\n      \"name\": \"VendorAccounts\",\n      \"type\": \"n8n-nodes-base.supabase\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -2560,\n        1320\n      ],\n      \"alwaysOutputData\": true,\n      \"executeOnce\": true,\n      \"credentials\": {\n        \"supabaseApi\": {\n          \"id\": \"U4Lx0acH9rOsOwsN\",\n          \"name\": \"Supabase InvoiceData\"\n        }\n      },\n      \"onError\": \"continueErrorOutput\"\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"append\",\n        \"documentId\": {\n          \"__rl\": true,\n          \"value\": \"1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit?usp=drivesdk\"\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"value\": \"gid=0\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit#gid=0\"\n        },\n        \"columns\": {\n          \"mappingMode\": \"defineBelow\",\n          \"value\": {\n            \"ParentDocumentID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ParentDocumentID }}\",\n            \"IssueDate\": \"={{ $('Invoice Data').item.json.choices[0].message.content.IssueDate }}\",\n            \"SenderParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_RegistrationName }}\",\n            \"SenderParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_CompanyID }}\",\n            \"ReceiverParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_RegistrationName }}\",\n            \"ReceiverParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_CompanyID }}\",\n            \"Error_Log\": \"Tercero Sin Parametrización\",\n            \"FileName\": \"={{ $('Get Files / XML').item.json.name }}\"\n          },\n          \"matchingColumns\": [],\n          \"schema\": [\n            {\n              \"id\": \"ParentDocumentID\",\n              \"displayName\": \"ParentDocumentID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"IssueDate\",\n              \"displayName\": \"IssueDate\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_RegistrationName\",\n              \"displayName\": \"SenderParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_CompanyID\",\n              \"displayName\": \"SenderParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_RegistrationName\",\n              \"displayName\": \"ReceiverParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_CompanyID\",\n              \"displayName\": \"ReceiverParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"FileName\",\n              \"displayName\": \"FileName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            },\n            {\n              \"id\": \"Error_Log\",\n              \"displayName\": \"Error_Log\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"c2cd6d9e-eba0-45a2-9b55-8db1b9b257c8\",\n      \"name\": \"Error Log 1\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"typeVersion\": 4.5,\n      \"position\": [\n        -2495,\n        2000\n      ],\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"gZ5bDsFFZ71b6qAI\",\n          \"name\": \"Google Sheets account 2\"\n        }\n      },\n      \"onError\": \"continueRegularOutput\"\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"append\",\n        \"documentId\": {\n          \"__rl\": true,\n          \"value\": \"1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit?usp=drivesdk\"\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"value\": \"gid=0\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit#gid=0\"\n        },\n        \"columns\": {\n          \"mappingMode\": \"defineBelow\",\n          \"value\": {\n            \"ParentDocumentID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ParentDocumentID }}\",\n            \"IssueDate\": \"={{ $('Invoice Data').item.json.choices[0].message.content.IssueDate }}\",\n            \"SenderParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_RegistrationName }}\",\n            \"SenderParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_CompanyID }}\",\n            \"ReceiverParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_RegistrationName }}\",\n            \"ReceiverParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_CompanyID }}\",\n            \"Error_Log\": \"Error AI - Descripción\",\n            \"FileName\": \"={{ $('Get Files / XML').item.json.name }}\"\n          },\n          \"matchingColumns\": [],\n          \"schema\": [\n            {\n              \"id\": \"ParentDocumentID\",\n              \"displayName\": \"ParentDocumentID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"IssueDate\",\n              \"displayName\": \"IssueDate\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_RegistrationName\",\n              \"displayName\": \"SenderParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_CompanyID\",\n              \"displayName\": \"SenderParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_RegistrationName\",\n              \"displayName\": \"ReceiverParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_CompanyID\",\n              \"displayName\": \"ReceiverParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"FileName\",\n              \"displayName\": \"FileName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            },\n            {\n              \"id\": \"Error_Log\",\n              \"displayName\": \"Error_Log\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"d1722e72-9648-492b-9ebd-ce4f8a4dade0\",\n      \"name\": \"Error Log 2\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"typeVersion\": 4.5,\n      \"position\": [\n        -1560,\n        2000\n      ],\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"gZ5bDsFFZ71b6qAI\",\n          \"name\": \"Google Sheets account 2\"\n        }\n      },\n      \"onError\": \"continueRegularOutput\"\n    },\n    {\n      \"parameters\": {\n        \"content\": \"# Extracción Data Facturas\\n\\n### - Transforma datos xml en binario base64\\n### - Extrae información tomando parámetros y elementos de la DIAN\\n### - Eror Handler --> archiva documento en carpeta error\\n\\n       *- Posibles errores:* \\n          *1. API Rate Limit \\n          *2. Archivo corrupto.\\n\\n### - Iteración entre los documentos en la carpeta\\n\\n\\n\",\n        \"height\": 1110.8428912735624,\n        \"width\": 1270.5924990890296,\n        \"color\": 7\n      },\n      \"id\": \"cafaaf38-e9cc-43b4-9d8d-d25b5de37704\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -3880,\n        1140\n      ]\n    },\n    {\n      \"parameters\": {\n        \"content\": \"# Parametrización Cuentas Terceros\\n\\n### - Para cada tercero parametriza las cuentas contales que se deben contemplar en la clasificación de las cuentas contables.\\n### - Descarta (Error) la factura si el tercero no tiene parametrización de cuentas. \\n\\n|\",\n        \"height\": 1290.5835299608977,\n        \"width\": 635.7848840015304,\n        \"color\": 7\n      },\n      \"id\": \"81ade73e-8cc7-4684-9cb9-447783eda0c5\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -2580,\n        960\n      ]\n    },\n    {\n      \"parameters\": {\n        \"content\": \"# Descripción Factura y Cargue DB información factura.\\n\\n### - Basado en los items del documento genera un breve resumen de la factura\\n### - Crea un listado \\\"plano\\\" de los items de la factura\\n### - Basado en el resumen y los items determina el tipo de gasto. Servicio, producto, activo e inventario.\\n### - Carga en DB únicamente información contenida en la factura\\n\",\n        \"height\": 1290.8716440016246,\n        \"width\": 1290.024852568322,\n        \"color\": 7\n      },\n      \"id\": \"1c5fd290-92ac-4c9c-a166-c4264b40e803\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -1880,\n        960\n      ]\n    },\n    {\n      \"parameters\": {\n        \"content\": \"# Clasificación Cuentas Contables\\n\\n### - Clasifica y asigna las cuentas contables para la factura, se basa en toda la información de la factura y las cuentas contables parametrizadas para el tercero.\\n### - Agrupa y todas las variables y ajusta el fomato para registrar los datos en la DB.\\n### - Mueve las facturas (archivos) a carpeta de extraidos. Si no hay error, mueve únicamente las facturas que fueron procesadas corrctamente\",\n        \"height\": 1518.9997432695227,\n        \"width\": 1223.679849492316,\n        \"color\": 7\n      },\n      \"id\": \"713939e8-7c43-4f50-a70b-ab63a679054a\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        4060,\n        720\n      ]\n    },\n    {\n      \"parameters\": {\n        \"content\": \"# Parametrización del Modelo\\n\\n### - Cargue parámetros para el modelo AI y prompts\\n### - Listado facturas disponibles para procesar\\n\\n\\n\",\n        \"height\": 910.2845438926778,\n        \"width\": 2468.8149736988726,\n        \"color\": 7\n      },\n      \"id\": \"831f068f-4cbb-4c60-8448-4b3994a14346\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -6386.53432026586,\n        1340\n      ]\n    },\n    {\n      \"parameters\": {\n        \"content\": \"## Error Handler \\nDocumento con el reporte de errores encontrados.\\n\\n**Click to View** \\n[Document - Error Log](https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit?usp=sharing)\\n\",\n        \"height\": 157.89419394781874,\n        \"width\": 370.10050008103264,\n        \"color\": 7\n      },\n      \"id\": \"12cb8188-dbe2-4dc8-879a-8669daaef8c6\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -2520,\n        1700\n      ]\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"b5db9061-d7ff-4482-98f9-f0c3ac0c4a18\",\n              \"name\": \"choices[0].message.content\",\n              \"value\": \"={{ $json.data[0] }}\",\n              \"type\": \"object\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"3843c131-785f-4223-9006-18c7d95017d6\",\n      \"name\": \"Invoice Data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        -2760,\n        1420\n      ],\n      \"executeOnce\": true,\n      \"notesInFlow\": true,\n      \"notes\": \"Prepara data de cada variable para utilizarla en nodos futuros. También organiza y consolida data para cargue a DB\"\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"6e73f4bb-83d9-4e82-a329-a2ce9a2e869c\",\n              \"name\": \"InvoiceData\",\n              \"value\": \"={{ $('Invoice Data').item.json.choices[0].message.content }}\",\n              \"type\": \"object\"\n            },\n            {\n              \"id\": \"a40922ae-c963-4382-8820-687a45c13d04\",\n              \"name\": \"TokenIn\",\n              \"value\": \"={{  parseInt($('Invoice Description').item.json.usage.prompt_tokens) }}\\n\",\n              \"type\": \"number\"\n            },\n            {\n              \"id\": \"b497f24b-3185-4ae2-8fb4-8e1e9cf60898\",\n              \"name\": \"TokenOut\",\n              \"value\": \"={{ parseInt($('Invoice Description').item.json.usage.completion_tokens) }}\",\n              \"type\": \"number\"\n            },\n            {\n              \"id\": \"66352388-d909-4b38-ade0-fe401a99db61\",\n              \"name\": \"Invoice_Description\",\n              \"value\": \"={{ $('Invoice Description').item.json.choices[0].message.content }}\",\n              \"type\": \"object\"\n            },\n            {\n              \"id\": \"be7d8fd4-d3b2-4356-badc-74b11913790f\",\n              \"name\": \"Account_Classification\",\n              \"value\": \"={{ $json.choices[0].message.content }}\",\n              \"type\": \"object\"\n            },\n            {\n              \"id\": \"118dbb9d-5823-4352-9879-e87fa70a1585\",\n              \"name\": \"TokenIn2\",\n              \"value\": \"={{ $json.usage.prompt_tokens }}\",\n              \"type\": \"number\"\n            },\n            {\n              \"id\": \"0cba95bd-248a-432c-a607-f18a001f4a24\",\n              \"name\": \"TokenOut2\",\n              \"value\": \"={{ $json.usage.completion_tokens }}\",\n              \"type\": \"number\"\n            },\n            {\n              \"id\": \"0614b95b-d447-494a-83f8-ce32f96c035a\",\n              \"name\": \"AI_Model\",\n              \"value\": \"={{ $('Invoice Description').item.json.model }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"95c40cdf-af6d-499e-98ea-5f3c087e465e\",\n              \"name\": \"AI_Model2\",\n              \"value\": \"={{ $json.model }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"2ca64fba-8eee-4369-ac81-8cc354e09eb1\",\n              \"name\": \"FileName\",\n              \"value\": \"={{ $('Get Files / XML').item.json.name }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"5d48a1ba-9608-4e6e-ab29-021b6d3e63c8\",\n              \"name\": \"FileFormat\",\n              \"value\": \"={{ $('Get Files / XML').item.json.mimeType }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"64d8f754-c155-4ed1-ab74-088e5ff47e49\",\n              \"name\": \"DataExtractionDate\",\n              \"value\": \"={{ new Date().toISOString() }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"34238d76-00c1-41b3-af43-4a6b57151a44\",\n              \"name\": \"CUFE\",\n              \"value\": \"={{ $('Invoice Data').item.json.choices[0].message.content.CUFE }}\",\n              \"type\": \"string\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"34cbddce-055e-424c-a709-ff2454f3becc\",\n      \"name\": \"All_Invoice_Data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        4287,\n        1040\n      ]\n    },\n    {\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"// Access the data from All_Invoice_data node\\nconst invoiceData = $json.InvoiceData;\\nconst invoiceDescription = $json.Invoice_Description;\\nconst accountClassification = $json.Account_Classification;\\n\\n// Check if InvoiceLine is an array or a string and handle accordingly\\nlet invoiceLineDescription;\\nif (Array.isArray(invoiceData.InvoiceLine)) {\\n  // If it's an array, use .map() to concatenate descriptions\\n  invoiceLineDescription = invoiceData.InvoiceLine.map(item => \\n    `\\\\tDescription: ${item.Description}\\\\n\\\\tInvoicedQuantity: ${item.InvoicedQuantity}\\\\n\\\\tPriceAmount: ${item.PriceAmount}\\\\n\\\\tLineExtensionAmount: ${item.LineExtensionAmount}`\\n  ).join(\\\"\\\\n\\\\n\\\");\\n} else {\\n  // If it's not an array (assuming it's a string), use it directly\\n  invoiceLineDescription = invoiceData.InvoiceLine;\\n}\\n\\n// Prepare the data to match the Supabase schema\\nreturn {\\n  json: {\\n    ParentDocumentID: invoiceData.ParentDocumentID,\\n    IssueDate: invoiceData.IssueDate,\\n    SenderParty_RegistrationName: invoiceData.SenderParty_RegistrationName,\\n    SenderParty_CompanyID: parseInt(invoiceData.SenderParty_CompanyID),\\n    ReceiverParty_RegistrationName: invoiceData.ReceiverParty_RegistrationName,\\n    ReceiverParty_CompanyID: parseInt(invoiceData.ReceiverParty_CompanyID),\\n    LineExtensionAmount: parseFloat(invoiceData.LineExtensionAmount).toFixed(2),\\n    TaxInclusiveAmount: parseFloat(invoiceData.TaxInclusiveAmount).toFixed(2),\\n    IVA: invoiceData.IVA ? parseFloat(invoiceData.IVA).toFixed(2) : 0,\\n    IC: invoiceData.IC ? parseFloat(invoiceData.IC).toFixed(2) : 0,\\n    ICA: invoiceData.ICA ? parseFloat(invoiceData.ICA).toFixed(2) : 0,\\n    INC: invoiceData.INC ? parseFloat(invoiceData.INC).toFixed(2) : 0,\\n    ReteIVA: invoiceData.ReteIVA ? parseFloat(invoiceData.ReteIVA).toFixed(2) : 0,\\n    ReteFuente: invoiceData.ReteFuente ? parseFloat(invoiceData.ReteFuente).toFixed(2) : 0,\\n    ReteICA: invoiceData.ReteICA ? parseFloat(invoiceData.ReteICA).toFixed(2) : 0,\\n    PayableAmount: parseFloat(invoiceData.PayableAmount).toFixed(2),\\n    \\n    // Set InvoiceLine (either the concatenated string or the original string)\\n    InvoiceLine: invoiceLineDescription,\\n\\n    // Add CUFE, DataExtractionDate and File information\\n    CUFE: $json.CUFE,\\n    DataExtractionDate: new Date().toISOString(),\\n    FileName: $json.FileName,\\n    FileFormat: $json.FileFormat,\\n\\n    // Add AI model and token information\\n    AI_Model: $json.AI_Model,\\n    TokenIn: parseInt($json.TokenIn),\\n    TokenOut: parseInt($json.TokenOut),\\n    AI_Model2: $json.AI_Model2,\\n    TokenIn2: parseInt($json.TokenIn2),\\n    TokenOut2: parseInt($json.TokenOut2),\\n\\n    // Invoice description and expense type\\n    InvoiceDescription: invoiceDescription.Description,\\n    ExpenseType: invoiceDescription.ExpenseType,\\n\\n    // Account Classification\\n    AccountNum1: accountClassification.AccountNum1 ? parseInt(accountClassification.AccountNum1) : null,\\n    AccountNum1_Des: accountClassification.AccountNum1_Des || null,\\n    AccountNum1_Val: accountClassification.AccountNum1_Val ? parseFloat(accountClassification.AccountNum1_Val).toFixed(2) : null,\\n    AccountNum1_Deb_Cred: accountClassification.AccountNum1_Deb_Cred || null,\\n\\n    AccountNum2: accountClassification.AccountNum2 ? parseInt(accountClassification.AccountNum2) : null,\\n    AccountNum2_Des: accountClassification.AccountNum2_Des || null,\\n    AccountNum2_Val: accountClassification.AccountNum2_Val ? parseFloat(accountClassification.AccountNum2_Val).toFixed(2) : null,\\n    AccountNum2_Deb_Cred: accountClassification.AccountNum2_Deb_Cred || null,\\n\\n\\n    AccountNum3: accountClassification.AccountNum3 ? parseInt(accountClassification.AccountNum3) : null,\\n    AccountNum3_Des: accountClassification.AccountNum3_Des || null,\\n    AccountNum3_Val: accountClassification.AccountNum3_Val ? parseFloat(accountClassification.AccountNum3_Val).toFixed(2) : null,\\n    AccountNum3_Deb_Cred: accountClassification.AccountNum3_Deb_Cred || null,\\n\\n    AccountNum4: accountClassification.AccountNum4 ? parseInt(accountClassification.AccountNum4) : null,\\n    AccountNum4_Des: accountClassification.AccountNum4_Des || null,\\n    AccountNum4_Val: accountClassification.AccountNum4_Val ? parseFloat(accountClassification.AccountNum4_Val).toFixed(2) : null,\\n    AccountNum4_Deb_Cred: accountClassification.AccountNum4_Deb_Cred || null,\\n\\n    AccountNum5: accountClassification.AccountNum5 ? parseInt(accountClassification.AccountNum5) : null,\\n    AccountNum5_Des: accountClassification.AccountNum5_Des || null,\\n    AccountNum5_Val: accountClassification.AccountNum5_Val ? parseFloat(accountClassification.AccountNum5_Val).toFixed(2) : null,\\n    AccountNum5_Deb_Cred: accountClassification.AccountNum5_Deb_Cred || null,\\n\\n    AccountNum6: accountClassification.AccountNum6 ? parseInt(accountClassification.AccountNum6) : null,\\n    AccountNum6_Des: accountClassification.AccountNum6_Des || null,\\n    AccountNum6_Val: accountClassification.AccountNum6_Val ? parseFloat(accountClassification.AccountNum6_Val).toFixed(2) : null,\\n    AccountNum6_Deb_Cred: accountClassification.AccountNum6_Deb_Cred || null,\\n\\n    AccountNum7: accountClassification.AccountNum7 ? parseInt(accountClassification.AccountNum7) : null,\\n    AccountNum7_Des: accountClassification.AccountNum7_Des || null,\\n    AccountNum7_Val: accountClassification.AccountNum7_Val ? parseFloat(accountClassification.AccountNum7_Val).toFixed(2) : null,\\n    AccountNum7_Deb_Cred: accountClassification.AccountNum7_Deb_Cred || null,\\n\\n    AccountNum8: accountClassification.AccountNum8 ? parseInt(accountClassification.AccountNum8) : null,\\n    AccountNum8_Des: accountClassification.AccountNum8_Des || null,\\n    AccountNum8_Deb_Cred: accountClassification.AccountNum8_Deb_Cred || null,\\n    \\n    // Confidence value\\n    Confidence: parseFloat(accountClassification.Confidence).toFixed(2),\\n  }\\n};\"\n      },\n      \"id\": \"cc242c95-623f-4476-91bb-0db1dab28c3f\",\n      \"name\": \"Prepare Data for DB\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        4487,\n        1040\n      ],\n      \"retryOnFail\": true,\n      \"maxTries\": 2,\n      \"onError\": \"continueErrorOutput\"\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"ed8075af-6738-468a-8ac4-806e0e652911\",\n              \"name\": \"InvoiceDescription\",\n              \"value\": \"={{ $json.choices[0].message.content }}\",\n              \"type\": \"object\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"62a0e9cf-e3c1-4013-8e33-ab8c94e4cec7\",\n      \"name\": \"Description\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        -1380,\n        1260\n      ]\n    },\n    {\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"id\": \"9950c6f0-28d1-485c-91b6-cf8b45cfa4c6\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"typeVersion\": 3,\n      \"position\": [\n        -4293,\n        1660\n      ]\n    },\n    {\n      \"parameters\": {\n        \"resource\": \"fileFolder\",\n        \"limit\": 1,\n        \"filter\": {\n          \"driveId\": {\n            \"mode\": \"list\",\n            \"value\": \"My Drive\"\n          },\n          \"folderId\": {\n            \"__rl\": true,\n            \"value\": \"1ZGtCbeZOm0ervZFwY4hPwOaktoo6o5Tx\",\n            \"mode\": \"list\",\n            \"cachedResultName\": \"Invoices\",\n            \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1ZGtCbeZOm0ervZFwY4hPwOaktoo6o5Tx\"\n          },\n          \"whatToSearch\": \"files\"\n        },\n        \"options\": {\n          \"fields\": [\n            \"name\",\n            \"mimeType\",\n            \"id\",\n            \"webViewLink\"\n          ]\n        }\n      },\n      \"id\": \"8ca33722-2832-4a81-a8dc-67b90ed7f419\",\n      \"name\": \"List Files\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"typeVersion\": 3,\n      \"position\": [\n        -4520,\n        1660\n      ],\n      \"executeOnce\": true,\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"wdsP0R2suhB5uk31\",\n          \"name\": \"Google Drive H&F\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"append\",\n        \"documentId\": {\n          \"__rl\": true,\n          \"value\": \"1uymiDrtTUcy56FMufL1tYpvFJMRH_3fqdP5QBO2f_zM\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Model Test\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1uymiDrtTUcy56FMufL1tYpvFJMRH_3fqdP5QBO2f_zM/edit?usp=drivesdk\"\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"value\": 2976192,\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Modelo_2\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1uymiDrtTUcy56FMufL1tYpvFJMRH_3fqdP5QBO2f_zM/edit#gid=2976192\"\n        },\n        \"columns\": {\n          \"mappingMode\": \"autoMapInputData\",\n          \"value\": {},\n          \"matchingColumns\": [],\n          \"schema\": [\n            {\n              \"id\": \"ParentDocumentID\",\n              \"displayName\": \"ParentDocumentID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"IssueDate\",\n              \"displayName\": \"IssueDate\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_RegistrationName\",\n              \"displayName\": \"SenderParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_CompanyID\",\n              \"displayName\": \"SenderParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_RegistrationName\",\n              \"displayName\": \"ReceiverParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_CompanyID\",\n              \"displayName\": \"ReceiverParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"LineExtensionAmount\",\n              \"displayName\": \"LineExtensionAmount\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"TaxInclusiveAmount\",\n              \"displayName\": \"TaxInclusiveAmount\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"IVA\",\n              \"displayName\": \"IVA\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"IC\",\n              \"displayName\": \"IC\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ICA\",\n              \"displayName\": \"ICA\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"INC\",\n              \"displayName\": \"INC\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReteIVA\",\n              \"displayName\": \"ReteIVA\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReteFuente\",\n              \"displayName\": \"ReteFuente\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReteICA\",\n              \"displayName\": \"ReteICA\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"PayableAmount\",\n              \"displayName\": \"PayableAmount\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"InvoiceLine\",\n              \"displayName\": \"InvoiceLine\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"DataExtractionDate\",\n              \"displayName\": \"DataExtractionDate\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"FileName\",\n              \"displayName\": \"FileName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"FileFormat\",\n              \"displayName\": \"FileFormat\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AI_Model\",\n              \"displayName\": \"AI_Model\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"TokenIn\",\n              \"displayName\": \"TokenIn\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"TokenOut\",\n              \"displayName\": \"TokenOut\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"InvoiceDescription\",\n              \"displayName\": \"InvoiceDescription\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ExpenseType\",\n              \"displayName\": \"ExpenseType\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum1\",\n              \"displayName\": \"AccountNum1\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum1_Des\",\n              \"displayName\": \"AccountNum1_Des\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum1_Val\",\n              \"displayName\": \"AccountNum1_Val\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum1_Deb_Cred\",\n              \"displayName\": \"AccountNum1_Deb_Cred\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum2\",\n              \"displayName\": \"AccountNum2\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum2_Des\",\n              \"displayName\": \"AccountNum2_Des\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum2_Val\",\n              \"displayName\": \"AccountNum2_Val\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum2_Deb_Cred\",\n              \"displayName\": \"AccountNum2_Deb_Cred\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum3\",\n              \"displayName\": \"AccountNum3\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum3_Des\",\n              \"displayName\": \"AccountNum3_Des\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum3_Val\",\n              \"displayName\": \"AccountNum3_Val\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum3_Deb_Cred\",\n              \"displayName\": \"AccountNum3_Deb_Cred\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum4\",\n              \"displayName\": \"AccountNum4\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum4_Des\",\n              \"displayName\": \"AccountNum4_Des\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum4_Val\",\n              \"displayName\": \"AccountNum4_Val\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum4_Deb_Cred\",\n              \"displayName\": \"AccountNum4_Deb_Cred\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum5\",\n              \"displayName\": \"AccountNum5\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum5_Des\",\n              \"displayName\": \"AccountNum5_Des\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum5_Val\",\n              \"displayName\": \"AccountNum5_Val\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum5_Deb_Cred\",\n              \"displayName\": \"AccountNum5_Deb_Cred\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum6\",\n              \"displayName\": \"AccountNum6\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum6_Des\",\n              \"displayName\": \"AccountNum6_Des\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum6_Val\",\n              \"displayName\": \"AccountNum6_Val\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum6_Deb_Cred\",\n              \"displayName\": \"AccountNum6_Deb_Cred\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum7\",\n              \"displayName\": \"AccountNum7\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum7_Des\",\n              \"displayName\": \"AccountNum7_Des\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum7_Val\",\n              \"displayName\": \"AccountNum7_Val\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum7_Deb_Cred\",\n              \"displayName\": \"AccountNum7_Deb_Cred\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum8\",\n              \"displayName\": \"AccountNum8\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum8_Des\",\n              \"displayName\": \"AccountNum8_Des\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum8_Val\",\n              \"displayName\": \"AccountNum8_Val\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AccountNum8_Deb_Cred\",\n              \"displayName\": \"AccountNum8_Deb_Cred\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Confidence\",\n              \"displayName\": \"Confidence\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Validation\",\n              \"displayName\": \"Validation\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"AI_Model2\",\n              \"displayName\": \"AI_Model2\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"TokenIn2\",\n              \"displayName\": \"TokenIn2\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"TokenOut2\",\n              \"displayName\": \"TokenOut2\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"CUFE\",\n              \"displayName\": \"CUFE\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"4114eca4-0021-4382-b318-192ae2754d6d\",\n      \"name\": \"Model Test\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"typeVersion\": 4.5,\n      \"position\": [\n        2040,\n        340\n      ],\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"gZ5bDsFFZ71b6qAI\",\n          \"name\": \"Google Sheets account 2\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"append\",\n        \"documentId\": {\n          \"__rl\": true,\n          \"value\": \"1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit?usp=drivesdk\"\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"value\": \"gid=0\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit#gid=0\"\n        },\n        \"columns\": {\n          \"mappingMode\": \"defineBelow\",\n          \"value\": {\n            \"ParentDocumentID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ParentDocumentID }}\",\n            \"IssueDate\": \"={{ $('Invoice Data').item.json.choices[0].message.content.IssueDate }}\",\n            \"SenderParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_RegistrationName }}\",\n            \"SenderParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_CompanyID }}\",\n            \"ReceiverParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_RegistrationName }}\",\n            \"ReceiverParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_CompanyID }}\",\n            \"Error_Log\": \"Error Script Convertir Variables DB\",\n            \"FileName\": \"={{ $('Get Files / XML').item.json.name }}\"\n          },\n          \"matchingColumns\": [],\n          \"schema\": [\n            {\n              \"id\": \"ParentDocumentID\",\n              \"displayName\": \"ParentDocumentID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"IssueDate\",\n              \"displayName\": \"IssueDate\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_RegistrationName\",\n              \"displayName\": \"SenderParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_CompanyID\",\n              \"displayName\": \"SenderParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_RegistrationName\",\n              \"displayName\": \"ReceiverParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_CompanyID\",\n              \"displayName\": \"ReceiverParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"FileName\",\n              \"displayName\": \"FileName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            },\n            {\n              \"id\": \"Error_Log\",\n              \"displayName\": \"Error_Log\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"e7149ed1-2a50-48f8-8a9a-615ff19ee336\",\n      \"name\": \"Error Log  4\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"typeVersion\": 4.5,\n      \"position\": [\n        4613,\n        1709\n      ],\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"gZ5bDsFFZ71b6qAI\",\n          \"name\": \"Google Sheets account 2\"\n        }\n      },\n      \"onError\": \"continueRegularOutput\"\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"append\",\n        \"documentId\": {\n          \"__rl\": true,\n          \"value\": \"1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit?usp=drivesdk\"\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"value\": \"gid=0\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit#gid=0\"\n        },\n        \"columns\": {\n          \"mappingMode\": \"defineBelow\",\n          \"value\": {\n            \"ParentDocumentID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ParentDocumentID }}\",\n            \"IssueDate\": \"={{ $('Invoice Data').item.json.choices[0].message.content.IssueDate }}\",\n            \"SenderParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_RegistrationName }}\",\n            \"SenderParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_CompanyID }}\",\n            \"ReceiverParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_RegistrationName }}\",\n            \"ReceiverParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_CompanyID }}\",\n            \"Error_Log\": \"Error AI - Clasificación Cuentas\",\n            \"FileName\": \"={{ $('Get Files / XML').item.json.name }}\"\n          },\n          \"matchingColumns\": [],\n          \"schema\": [\n            {\n              \"id\": \"ParentDocumentID\",\n              \"displayName\": \"ParentDocumentID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"IssueDate\",\n              \"displayName\": \"IssueDate\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_RegistrationName\",\n              \"displayName\": \"SenderParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_CompanyID\",\n              \"displayName\": \"SenderParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_RegistrationName\",\n              \"displayName\": \"ReceiverParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_CompanyID\",\n              \"displayName\": \"ReceiverParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"FileName\",\n              \"displayName\": \"FileName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            },\n            {\n              \"id\": \"Error_Log\",\n              \"displayName\": \"Error_Log\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"275d35e1-ea6a-49dc-9da7-6931c1c8e0ba\",\n      \"name\": \"Error Log  3\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"typeVersion\": 4.5,\n      \"position\": [\n        4153,\n        1709\n      ],\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"gZ5bDsFFZ71b6qAI\",\n          \"name\": \"Google Sheets account 2\"\n        }\n      },\n      \"onError\": \"continueRegularOutput\"\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"append\",\n        \"documentId\": {\n          \"__rl\": true,\n          \"value\": \"1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit?usp=drivesdk\"\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"value\": \"gid=0\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit#gid=0\"\n        },\n        \"columns\": {\n          \"mappingMode\": \"defineBelow\",\n          \"value\": {\n            \"ParentDocumentID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ParentDocumentID }}\",\n            \"IssueDate\": \"={{ $('Invoice Data').item.json.choices[0].message.content.IssueDate }}\",\n            \"SenderParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_RegistrationName }}\",\n            \"SenderParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_CompanyID }}\",\n            \"ReceiverParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_RegistrationName }}\",\n            \"ReceiverParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_CompanyID }}\",\n            \"Error_Log\": \"Error Cargue DB\",\n            \"FileName\": \"={{ $('Get Files / XML').item.json.name }}\"\n          },\n          \"matchingColumns\": [],\n          \"schema\": [\n            {\n              \"id\": \"ParentDocumentID\",\n              \"displayName\": \"ParentDocumentID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"IssueDate\",\n              \"displayName\": \"IssueDate\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_RegistrationName\",\n              \"displayName\": \"SenderParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_CompanyID\",\n              \"displayName\": \"SenderParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_RegistrationName\",\n              \"displayName\": \"ReceiverParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_CompanyID\",\n              \"displayName\": \"ReceiverParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"FileName\",\n              \"displayName\": \"FileName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            },\n            {\n              \"id\": \"Error_Log\",\n              \"displayName\": \"Error_Log\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"c3de2eb3-2511-4fec-9d87-a8acc181f92c\",\n      \"name\": \"Error Log  5\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"typeVersion\": 4.5,\n      \"position\": [\n        4793,\n        1709\n      ],\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"gZ5bDsFFZ71b6qAI\",\n          \"name\": \"Google Sheets account 2\"\n        }\n      },\n      \"onError\": \"continueRegularOutput\"\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"append\",\n        \"documentId\": {\n          \"__rl\": true,\n          \"value\": \"1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit?usp=drivesdk\"\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"value\": \"gid=0\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error Log\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit#gid=0\"\n        },\n        \"columns\": {\n          \"mappingMode\": \"defineBelow\",\n          \"value\": {\n            \"ParentDocumentID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ParentDocumentID }}\",\n            \"IssueDate\": \"={{ $('Invoice Data').item.json.choices[0].message.content.IssueDate }}\",\n            \"SenderParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_RegistrationName }}\",\n            \"SenderParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.SenderParty_CompanyID }}\",\n            \"ReceiverParty_RegistrationName\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_RegistrationName }}\",\n            \"ReceiverParty_CompanyID\": \"={{ $('Invoice Data').item.json.choices[0].message.content.ReceiverParty_CompanyID }}\",\n            \"Error_Log\": \"Error Script Extracción Data\",\n            \"FileName\": \"={{ $('Get Files / XML').item.json.name }}\"\n          },\n          \"matchingColumns\": [],\n          \"schema\": [\n            {\n              \"id\": \"ParentDocumentID\",\n              \"displayName\": \"ParentDocumentID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"IssueDate\",\n              \"displayName\": \"IssueDate\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_RegistrationName\",\n              \"displayName\": \"SenderParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SenderParty_CompanyID\",\n              \"displayName\": \"SenderParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_RegistrationName\",\n              \"displayName\": \"ReceiverParty_RegistrationName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ReceiverParty_CompanyID\",\n              \"displayName\": \"ReceiverParty_CompanyID\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"FileName\",\n              \"displayName\": \"FileName\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            },\n            {\n              \"id\": \"Error_Log\",\n              \"displayName\": \"Error_Log\",\n              \"required\": false,\n              \"defaultMatch\": false,\n              \"display\": true,\n              \"type\": \"string\",\n              \"canBeUsedToMatch\": true,\n              \"removed\": false\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"62ac3980-6bce-45d0-b6dc-5a3baf114559\",\n      \"name\": \"Error Log \",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"typeVersion\": 4.5,\n      \"position\": [\n        -3200,\n        2000\n      ],\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"gZ5bDsFFZ71b6qAI\",\n          \"name\": \"Google Sheets account 2\"\n        }\n      },\n      \"onError\": \"continueRegularOutput\"\n    },\n    {\n      \"parameters\": {\n        \"content\": \"# Ajustar DB \\n\\n\\nArreglar DB con nuevas variables\"\n      },\n      \"id\": \"85f0c82e-5bfe-4ac3-9beb-2ec203d7ffd1\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        4960,\n        1000\n      ]\n    },\n    {\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"id\": \"3e3bd4c5-04d5-4bc7-80d1-440a98674ebd\",\n      \"name\": \"XML\",\n      \"type\": \"n8n-nodes-base.xml\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -3440,\n        1580\n      ]\n    },\n    {\n      \"parameters\": {\n        \"resource\": \"folder\",\n        \"folderId\": \"Invoices\"\n      },\n      \"id\": \"cff2702e-ea48-4bd6-b474-563a1c1e9280\",\n      \"name\": \"Microsoft OneDrive\",\n      \"type\": \"n8n-nodes-base.microsoftOneDrive\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -5480,\n        1080\n      ],\n      \"credentials\": {\n        \"microsoftOneDriveOAuth2Api\": {\n          \"id\": \"VuffFQLziQK9I5pc\",\n          \"name\": \"Microsoft Drive account\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"content\": \"# Revisión Responsabilidad ReteFuente\\n\\n### - Revisa la data en la data del flujo el item \\\"TaxLevelCode\\\", toma el código y lo compara con la base en SupaBase con el mismo nombre.\\n### - Revisa el código y trae el nombre del régimen para el tercero.\\n\",\n        \"height\": 1500.811141039242,\n        \"width\": 617.560566052625,\n        \"color\": 7\n      },\n      \"id\": \"7499b0a8-d603-447d-976c-c4a8c718540b\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -550,\n        750\n      ]\n    },\n    {\n      \"parameters\": {\n        \"content\": \"# Liquidación  ReteFuente\\n\\n### - Revisa la data para confirmar que la ciudad en la que se genera la factura no es la misma que la ciudad en que esta registrado el comprador. Sí es así, no debe tener ReteICA.\\n### - Después de revisar la ciudad, valida la base de datos de la actividad del generador, junto con la descripción de la factura para confirmar si aplica o no alguna retención. \\n### - Si no es autorretenedor se aplica retención en la fuente.\",\n        \"height\": 1500.9269436130044,\n        \"width\": 2118.2534337019747,\n        \"color\": 7\n      },\n      \"id\": \"028989e4-056d-4b0c-9855-b20cd9f5d71f\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        120,\n        760\n      ]\n    },\n    {\n      \"parameters\": {\n        \"jsCode\": \"// Extract the data from the previous node\\nconst invoiceData = items[0].json.Invoice;\\n\\n// Initialize the result object with the necessary fields\\nconst result = {\\n  ParentDocumentID: invoiceData[\\\"cbc:ID\\\"] || \\\"\\\",\\n  IssueDate: invoiceData[\\\"cbc:IssueDate\\\"] || \\\"\\\",\\n  \\n  // Sender Party details\\n  SenderParty_RegistrationName: invoiceData[\\\"cac:AccountingSupplierParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PartyTaxScheme\\\"]?.[\\\"cbc:RegistrationName\\\"] || \\\"\\\",\\n  SenderParty_CompanyID: invoiceData[\\\"cac:AccountingSupplierParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PartyTaxScheme\\\"]?.[\\\"cbc:CompanyID\\\"]?._ || \\\"\\\",\\n  SenderParty_CityID: invoiceData[\\\"cac:AccountingSupplierParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PhysicalLocation\\\"]?.[\\\"cac:Address\\\"]?.[\\\"cbc:ID\\\"] || \\\"\\\",\\n  SenderParty_CityName: invoiceData[\\\"cac:AccountingSupplierParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PhysicalLocation\\\"]?.[\\\"cac:Address\\\"]?.[\\\"cbc:CityName\\\"] || \\\"\\\",\\n  SenderParty_TaxLevelCode: invoiceData[\\\"cac:AccountingSupplierParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PartyTaxScheme\\\"]?.[\\\"cbc:TaxLevelCode\\\"]?._ || \\\"\\\",\\n  SenderParty_IndustryClassificationCode: invoiceData[\\\"cac:AccountingSupplierParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cbc:IndustryClassificationCode\\\"] || \\\"\\\",\\n  SenderParty_CompanyType: invoiceData[\\\"cac:AccountingSupplierParty\\\"]?.[\\\"cbc:AdditionalAccountID\\\"] || \\\"\\\",\\n  \\n  // Receiver Party details\\n  ReceiverParty_RegistrationName: invoiceData[\\\"cac:AccountingCustomerParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PartyTaxScheme\\\"]?.[\\\"cbc:RegistrationName\\\"] || \\\"\\\",\\n  ReceiverParty_CompanyID: invoiceData[\\\"cac:AccountingCustomerParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PartyTaxScheme\\\"]?.[\\\"cbc:CompanyID\\\"]?._ || \\\"\\\",\\n  ReceiverParty_CityID: invoiceData[\\\"cac:AccountingCustomerParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PhysicalLocation\\\"]?.[\\\"cac:Address\\\"]?.[\\\"cbc:ID\\\"] || \\\"\\\",\\n  ReceiverParty_CityName: invoiceData[\\\"cac:AccountingCustomerParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PhysicalLocation\\\"]?.[\\\"cac:Address\\\"]?.[\\\"cbc:CityName\\\"] || \\\"\\\",\\n  ReceiverParty_TaxLevelCode: invoiceData[\\\"cac:AccountingCustomerParty\\\"]?.[\\\"cac:Party\\\"]?.[\\\"cac:PartyTaxScheme\\\"]?.[\\\"cbc:TaxLevelCode\\\"]?._ || \\\"\\\",\\n\\n\\n  // Other existing fields\\n  LineExtensionAmount: invoiceData[\\\"cac:LegalMonetaryTotal\\\"]?.[\\\"cbc:LineExtensionAmount\\\"]?._ || \\\"\\\",\\n  TaxInclusiveAmount: invoiceData[\\\"cac:LegalMonetaryTotal\\\"]?.[\\\"cbc:TaxInclusiveAmount\\\"]?._ || \\\"\\\",\\n\\n  IVA: \\\"\\\",\\n  IC: \\\"\\\",\\n  ICA: \\\"\\\",\\n  INC: \\\"\\\",\\n  ReteIVA: \\\"\\\",\\n  ReteFuente: \\\"\\\",\\n  ReteICA: \\\"\\\",\\n  \\n  PayableAmount: invoiceData[\\\"cac:LegalMonetaryTotal\\\"]?.[\\\"cbc:PayableAmount\\\"]?._ || \\\"\\\",\\n\\n  LineCountNumeric: invoiceData[\\\"cbc:LineCountNumeric\\\"] || \\\"\\\",\\n  \\n  InvoiceLine: \\\"\\\",\\n  CUFE: invoiceData[\\\"cbc:UUID\\\"]?._ || \\\"\\\",\\n  \\n  // New variables for InvoiceTypeCode and DocumentCurrencyCode\\n  InvoiceTypeCode: invoiceData[\\\"cbc:InvoiceTypeCode\\\"] || \\\"\\\",\\n  DocumentCurrencyCode: invoiceData[\\\"cbc:DocumentCurrencyCode\\\"] || \\\"\\\",\\n\\n  // Eventos de un Documento Electrónico: cbc:DocumentResponse/Description; cbc:ResponseCode\\n  DocumentResponseDescription: invoiceData[\\\"cac:DocumentResponse\\\"]?.[\\\"cbc:Description\\\"] || \\\"\\\",\\n  DocumentResponseCode: invoiceData[\\\"cac:DocumentResponse\\\"]?.[\\\"cbc:ResponseCode\\\"] || \\\"\\\"\\n};\\n\\n// Extract tax information\\nconst taxDetails = invoiceData[\\\"cac:TaxTotal\\\"]?.[\\\"cac:TaxSubtotal\\\"];\\nif (Array.isArray(taxDetails)) {\\n  // Iterate through the array to find IVA\\n  result.IVA = taxDetails\\n    .filter(subtotal => subtotal[\\\"cac:TaxCategory\\\"]?.[\\\"cac:TaxScheme\\\"]?.[\\\"cbc:ID\\\"] === \\\"01\\\")\\n    .map(subtotal => parseFloat(subtotal[\\\"cbc:TaxAmount\\\"]?._ || \\\"0\\\"))\\n    .reduce((acc, amount) => acc + amount, 0)\\n    .toFixed(2); // Sum all IVA amounts\\n} else if (taxDetails?.[\\\"cac:TaxCategory\\\"]?.[\\\"cac:TaxScheme\\\"]?.[\\\"cbc:ID\\\"] === \\\"01\\\") {\\n  result.IVA = taxDetails[\\\"cbc:TaxAmount\\\"]?._ || \\\"\\\";\\n}\\n\\n// Extract withholding taxes\\nconst withholdingTaxes = invoiceData[\\\"cac:WithholdingTaxTotal\\\"];\\nif (Array.isArray(withholdingTaxes)) {\\n  withholdingTaxes.forEach((tax) => {\\n    const taxSchemeID = tax[\\\"cac:TaxSubtotal\\\"]?.[\\\"cac:TaxCategory\\\"]?.[\\\"cac:TaxScheme\\\"]?.[\\\"cbc:ID\\\"];\\n    const taxAmount = parseFloat(tax[\\\"cac:TaxSubtotal\\\"]?.[\\\"cbc:TaxAmount\\\"]?._ || \\\"0\\\");\\n    switch (taxSchemeID) {\\n      case \\\"05\\\":\\n        result.ReteIVA = (parseFloat(result.ReteIVA) || 0) + taxAmount;\\n        break;\\n      case \\\"06\\\":\\n        result.ReteFuente = (parseFloat(result.ReteFuente) || 0) + taxAmount;\\n        break;\\n      case \\\"07\\\":\\n        result.ReteICA = (parseFloat(result.ReteICA) || 0) + taxAmount;\\n        break;\\n    }\\n  });\\n\\n  // Convert to strings to avoid potential type mismatch\\n  result.ReteIVA = result.ReteIVA ? result.ReteIVA.toFixed(2) : \\\"\\\";\\n  result.ReteFuente = result.ReteFuente ? result.ReteFuente.toFixed(2) : \\\"\\\";\\n  result.ReteICA = result.ReteICA ? result.ReteICA.toFixed(2) : \\\"\\\";\\n}\\n\\n// Extract invoice line items\\nconst invoiceLines = invoiceData[\\\"cac:InvoiceLine\\\"];\\nlet invoiceLineDescriptions = [];\\n\\nif (Array.isArray(invoiceLines)) {\\n  // If it's an array, loop through each invoice line\\n  invoiceLines.forEach(invoiceLine => {\\n    const description = invoiceLine[\\\"cac:Item\\\"]?.[\\\"cbc:Description\\\"] || \\\"\\\";\\n    const quantity = invoiceLine[\\\"cbc:InvoicedQuantity\\\"]?._ || \\\"\\\";\\n    const unitValue = invoiceLine[\\\"cac:Price\\\"]?.[\\\"cbc:PriceAmount\\\"]?._ || \\\"\\\";\\n    const totalValue = invoiceLine[\\\"cbc:LineExtensionAmount\\\"]?._ || \\\"\\\";\\n\\n    invoiceLineDescriptions.push(`Description: ${description}, Quantity: ${quantity}, Unit Value: ${unitValue}, Total Value: ${totalValue}`);\\n  });\\n} else if (invoiceLines) {\\n  // If it's a single object\\n  const description = invoiceLines[\\\"cac:Item\\\"]?.[\\\"cbc:Description\\\"] || \\\"\\\";\\n  const quantity = invoiceLines[\\\"cbc:InvoicedQuantity\\\"]?._ || \\\"\\\";\\n  const unitValue = invoiceLines[\\\"cac:Price\\\"]?.[\\\"cbc:PriceAmount\\\"]?._ || \\\"\\\";\\n  const totalValue = invoiceLines[\\\"cbc:LineExtensionAmount\\\"]?._ || \\\"\\\";\\n\\n  invoiceLineDescriptions.push(`Description: ${description}, Quantity: ${quantity}, Unit Value: ${unitValue}, Total Value: ${totalValue}`);\\n}\\n\\n// Combine all invoice lines into a single string, separated by semicolons\\nresult.InvoiceLine = invoiceLineDescriptions.join(\\\"; \\\");\\n\\n// Return the result as JSON\\nreturn [{ json: result }];\"\n      },\n      \"id\": \"cd03464f-92bc-4636-ac2a-2916f2eefe12\",\n      \"name\": \"Extract XML Data\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        -3220,\n        1440\n      ],\n      \"alwaysOutputData\": true,\n      \"onError\": \"continueErrorOutput\"\n    },\n    {\n      \"parameters\": {\n        \"aggregate\": \"aggregateAllItemData\",\n        \"options\": {}\n      },\n      \"id\": \"40d624ac-9129-437d-af2e-c566a22ff889\",\n      \"name\": \"Agregador DataXML\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -2960,\n        1420\n      ],\n      \"notesInFlow\": true,\n      \"executeOnce\": true,\n      \"notes\": \"Agregador Data XML de la factura en un output único\"\n    },\n    {\n      \"parameters\": {\n        \"jsCode\": \"// Access the 'Invoice' data from the XML to JSON node\\nconst invoiceData = items[0].json.Invoice;\\n\\n// Extract invoice line items from the XML data\\nconst invoiceLines = invoiceData[\\\"cac:InvoiceLine\\\"];\\nlet result = {};  // Initialize the result object\\n\\n// Check if 'InvoiceLine' is an array and process each item\\nif (Array.isArray(invoiceLines)) {\\n  invoiceLines.forEach((invoiceLine, index) => {\\n    const description = invoiceLine[\\\"cac:Item\\\"]?.[\\\"cbc:Description\\\"] || \\\"\\\";\\n    const quantity = invoiceLine[\\\"cbc:InvoicedQuantity\\\"]?._ || \\\"\\\";\\n    const unitValue = invoiceLine[\\\"cac:Price\\\"]?.[\\\"cbc:PriceAmount\\\"]?._ || \\\"\\\";\\n    const totalValue = invoiceLine[\\\"cbc:LineExtensionAmount\\\"]?._ || \\\"\\\";\\n\\n    // Create a key for each item (item_1, item_2, etc.)\\n    result[`item_${index + 1}`] = {\\n      \\\"Description\\\": description,\\n      \\\"Quantity\\\": quantity,\\n      \\\"Unit_Value\\\": unitValue,\\n      \\\"Total_Value\\\": totalValue\\n    };\\n  });\\n} else if (invoiceLines) {\\n  // If there's only one item (not an array)\\n  const description = invoiceLines[\\\"cac:Item\\\"]?.[\\\"cbc:Description\\\"] || \\\"\\\";\\n  const quantity = invoiceLines[\\\"cbc:InvoicedQuantity\\\"]?._ || \\\"\\\";\\n  const unitValue = invoiceLines[\\\"cac:Price\\\"]?.[\\\"cbc:PriceAmount\\\"]?._ || \\\"\\\";\\n  const totalValue = invoiceLines[\\\"cbc:LineExtensionAmount\\\"]?._ || \\\"\\\";\\n\\n  // Handle the single item case\\n  result[\\\"item_1\\\"] = {\\n    \\\"Description\\\": description,\\n    \\\"Quantity\\\": quantity,\\n    \\\"Unit_Value\\\": unitValue,\\n    \\\"Total_Value\\\": totalValue\\n  };\\n}\\n\\n// Return the result as the output\\nreturn [{ json: result }];\\n\"\n      },\n      \"id\": \"bfdcfbb1-bf27-4820-9004-90ee495ecee4\",\n      \"name\": \"Extract Items\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        -3220,\n        1740\n      ],\n      \"alwaysOutputData\": true,\n      \"onError\": \"continueErrorOutput\"\n    },\n    {\n      \"parameters\": {\n        \"aggregate\": \"aggregateAllItemData\",\n        \"options\": {}\n      },\n      \"id\": \"3cc5b737-417e-4023-8e2d-cd9d2a888291\",\n      \"name\": \"Agregador Items\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -2960,\n        1720\n      ],\n      \"notesInFlow\": true,\n      \"executeOnce\": true,\n      \"notes\": \"Agregador Items XML de la factura en un output único\"\n    },\n    {\n      \"parameters\": {\n        \"content\": \"## Error Handler \\nDocumento con el reporte de errores encontrados.\\n\\n**Click to View** \\n[Document - Error Log](https://docs.google.com/spreadsheets/d/1G618RMtrzF5pecMAvATctu5CLl6dpL-qdKNpWaXx0mI/edit?usp=sharing)\\n\",\n        \"height\": 156.85968088445503,\n        \"width\": 370.10050008103264,\n        \"color\": 7\n      },\n      \"id\": \"71f21e7f-acd9-45e4-a608-4d5d00130c34\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -1560,\n        1700\n      ]\n    },\n    {\n      \"parameters\": {\n        \"conditions\": {\n          \"options\": {\n            \"caseSensitive\": true,\n            \"leftValue\": \"\",\n            \"typeValidation\": \"strict\",\n            \"version\": 1\n          },\n          \"conditions\": [\n            {\n              \"id\": \"31fce415-158f-4f3a-95ab-abde72f17a66\",\n              \"leftValue\": \"={{ $json.data[0] }}\",\n              \"rightValue\": \"[empty]\",\n              \"operator\": {\n                \"type\": \"object\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              }\n            }\n          ],\n          \"combinator\": \"and\"\n        },\n        \"options\": {}\n      },\n      \"id\": \"d5922e83-e8f5-49e1-9ed1-09d97e6e881f\",\n      \"name\": \"If1\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"typeVersion\": 2.1,\n      \"position\": [\n        -1825,\n        1300\n      ]\n    },\n    {\n      \"parameters\": {\n        \"jsCode\": \"// Function to remove null values from an object\\nconst removeNulls = (obj) => {\\n  for (const key in obj) {\\n    if (obj[key] === null) {\\n      delete obj[key];\\n    }\\n  }\\n  return obj;\\n};\\n\\n// Apply the function to each item in the 'items' array provided by n8n\\nreturn items.map(item => {\\n  const cleanedData = removeNulls(item.json);\\n  return {\\n    json: cleanedData\\n  };\\n});\"\n      },\n      \"id\": \"45f55816-68e1-4adc-ba21-7065e2455b3d\",\n      \"name\": \"Clean JSON\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        -2325,\n        1300\n      ],\n      \"notes\": \"Parametrización Terceros. Retorna únicamente variables con valor\"\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"search\",\n        \"base\": {\n          \"__rl\": true,\n          \"value\": \"appxDB6mSqj7XDzIC\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"InvoiceData\",\n          \"cachedResultUrl\": \"https://airtable.com/appxDB6mSqj7XDzIC\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"value\": \"tblPHIUqpr9gmLfZJ\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"AIModels_Prompts\",\n          \"cachedResultUrl\": \"https://airtable.com/appxDB6mSqj7XDzIC/tblPHIUqpr9gmLfZJ\"\n        },\n        \"filterByFormula\": \"ActualProject = \\\"Accounting Records\\\"\",\n        \"options\": {},\n        \"sort\": {\n          \"property\": [\n            {\n              \"field\": \"ID\"\n            }\n          ]\n        }\n      },\n      \"id\": \"3588353b-f543-4fff-9c64-19f13d61e4d8\",\n      \"name\": \"AI_Variables\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"typeVersion\": 2.1,\n      \"position\": [\n        -4740,\n        1660\n      ],\n      \"executeOnce\": true,\n      \"credentials\": {\n        \"airtableTokenApi\": {\n          \"id\": \"qt2DSN1Xi7hBivEb\",\n          \"name\": \"Airtable Personal Access Token\"\n        }\n      },\n      \"notes\": \"Parametrización modelos AI y Prompts\"\n    },\n    {\n      \"parameters\": {\n        \"aggregate\": \"aggregateAllItemData\",\n        \"options\": {}\n      },\n      \"id\": \"c68bfc74-4a75-42c7-85b0-46a6347ef131\",\n      \"name\": \"Agregador Parm Terceros\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -2125,\n        1300\n      ],\n      \"alwaysOutputData\": false,\n      \"executeOnce\": true,\n      \"notes\": \"Agregador Parametrizacion Información Terceros\"\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"6e73f4bb-83d9-4e82-a329-a2ce9a2e869c\",\n              \"name\": \"InvoiceData\",\n              \"value\": \"={{ $('Invoice Data').item.json.choices[0].message.content }}\",\n              \"type\": \"object\"\n            },\n            {\n              \"id\": \"a40922ae-c963-4382-8820-687a45c13d04\",\n              \"name\": \"TokenIn\",\n              \"value\": \"={{  parseInt($('Invoice Description').item.json.usage.prompt_tokens) }}\\n\",\n              \"type\": \"number\"\n            },\n            {\n              \"id\": \"b497f24b-3185-4ae2-8fb4-8e1e9cf60898\",\n              \"name\": \"TokenOut\",\n              \"value\": \"={{ parseInt($('Invoice Description').item.json.usage.completion_tokens) }}\",\n              \"type\": \"number\"\n            },\n            {\n              \"id\": \"66352388-d909-4b38-ade0-fe401a99db61\",\n              \"name\": \"Invoice_Description\",\n              \"value\": \"={{ $('Invoice Description').item.json.choices[0].message.content }}\",\n              \"type\": \"object\"\n            },\n            {\n              \"id\": \"0614b95b-d447-494a-83f8-ce32f96c035a\",\n              \"name\": \"AI_Model\",\n              \"value\": \"={{ $('Invoice Description').item.json.model }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"2ca64fba-8eee-4369-ac81-8cc354e09eb1\",\n              \"name\": \"FileName\",\n              \"value\": \"={{ $('Get Files / XML').item.json.name }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"5d48a1ba-9608-4e6e-ab29-021b6d3e63c8\",\n              \"name\": \"FileFormat\",\n              \"value\": \"={{ $('Get Files / XML').item.json.mimeType }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"64d8f754-c155-4ed1-ab74-088e5ff47e49\",\n              \"name\": \"DataExtractionDate\",\n              \"value\": \"={{ new Date().toISOString() }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"34238d76-00c1-41b3-af43-4a6b57151a44\",\n              \"name\": \"CUFE\",\n              \"value\": \"={{ $('Invoice Data').item.json.choices[0].message.content.CUFE }}\",\n              \"type\": \"string\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"aba1fa70-e0ca-44d8-88e9-a7cdb3539400\",\n      \"name\": \"Data_XML_Invoice\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        -1180,\n        1260\n      ],\n      \"notesInFlow\": true,\n      \"executeOnce\": true,\n      \"notes\": \"Consolida información básica de la factura en formato XML para enviarla a DB\"\n    },\n    {\n      \"parameters\": {\n        \"jsCode\": \"// Iterate over all items in the input\\nreturn items.map(item => {\\n    const jsonOutput = item.json; // This will get the input JSON for the current item\\n\\n    const invoiceData = jsonOutput.InvoiceData || {};\\n    const invoiceDescription = jsonOutput.Invoice_Description || {};\\n\\n    // Prepare the object for Supabase insertion\\n    const preparedData = {\\n        ParentDocumentID: invoiceData.ParentDocumentID || null,\\n        IssueDate: invoiceData.IssueDate || null,\\n        SenderParty_RegistrationName: invoiceData.SenderParty_RegistrationName || null,\\n        SenderParty_CompanyID: parseFloat(invoiceData.SenderParty_CompanyID) || null,\\n        SenderParty_CityID: invoiceData.SenderParty_CityID || null,\\n        SenderParty_CityName: invoiceData.SenderParty_CityName || null,\\n        SenderParty_TaxLevelCode: invoiceData.SenderParty_TaxLevelCode || null,\\n        SenderParty_IndustryClassificationCode: invoiceData.SenderParty_IndustryClassificationCode || null,\\n        ReceiverParty_RegistrationName: invoiceData.ReceiverParty_RegistrationName || null,\\n        ReceiverParty_CompanyID: parseFloat(invoiceData.ReceiverParty_CompanyID) || null,\\n        ReceiverParty_CityID: invoiceData.ReceiverParty_CityID || null,\\n        ReceiverParty_CityName: invoiceData.ReceiverParty_CityName || null,\\n        ReceiverParty_TaxLevelCode: invoiceData.ReceiverParty_TaxLevelCode || null,\\n        LineExtensionAmount: parseFloat(invoiceData.LineExtensionAmount) || null,\\n        TaxInclusiveAmount: parseFloat(invoiceData.TaxInclusiveAmount) || null,\\n        IVA: parseFloat(invoiceData.IVA) || null,\\n        IC: parseFloat(invoiceData.IC) || null,\\n        ICA: parseFloat(invoiceData.ICA) || null,\\n        INC: parseFloat(invoiceData.INC) || null,\\n        ReteIVA: parseFloat(invoiceData.ReteIVA) || null,\\n        ReteFuente: parseFloat(invoiceData.ReteFuente) || null,\\n        ReteICA: parseFloat(invoiceData.ReteICA) || null,\\n        PayableAmount: parseFloat(invoiceData.PayableAmount) || null,\\n        LineCountNumeric: parseInt(invoiceData.LineCountNumeric, 10) || null,\\n        InvoiceLine: invoiceData.InvoiceLine || null,\\n        CUFE: invoiceData.CUFE || null,\\n        InvoiceTypeCode: invoiceData.InvoiceTypeCode || null,\\n        DocumentCurrencyCode: invoiceData.DocumentCurrencyCode || null,\\n        DocumentResponseDescription: invoiceData.DocumentResponseDescription || null,\\n        DocumentResponseCode: invoiceData.DocumentResponseCode || null,\\n        InvoiceDescription: invoiceDescription.Description || null,\\n        ExpenseType: invoiceDescription.ExpenseType || null,\\n        DataExtractionDate: jsonOutput.DataExtractionDate || null,\\n        FileName: jsonOutput.FileName || null,\\n        FileFormat: jsonOutput.FileFormat || null,\\n        AI_Model: jsonOutput.AI_Model || null,\\n        TokenIn: parseInt(jsonOutput.TokenIn, 10) || null,\\n        TokenOut: parseInt(jsonOutput.TokenOut, 10) || null\\n    };\\n    \\n    return {\\n        json: preparedData // Output the prepared data in the correct format for the next node\\n    };\\n});\"\n      },\n      \"id\": \"6084c3ec-29a9-4abd-a39f-319a7b2f9a73\",\n      \"name\": \"Format_XMLInvoice_Data\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        -940,\n        1260\n      ],\n      \"notesInFlow\": true,\n      \"executeOnce\": true,\n      \"alwaysOutputData\": true,\n      \"notes\": \"Prepara data factura para enviar a DB\"\n    },\n    {\n      \"parameters\": {\n        \"tableId\": \"InvoicesData\",\n        \"dataToSend\": \"autoMapInputData\"\n      },\n      \"id\": \"bc1ef138-d1f8-489e-8d11-2fd749a05e63\",\n      \"name\": \"Upload Invoice Data\",\n      \"type\": \"n8n-nodes-base.supabase\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -760,\n        1260\n      ],\n      \"executeOnce\": true,\n      \"alwaysOutputData\": true,\n      \"credentials\": {\n        \"supabaseApi\": {\n          \"id\": \"U4Lx0acH9rOsOwsN\",\n          \"name\": \"Supabase InvoiceData\"\n        }\n      },\n      \"onError\": \"continueRegularOutput\"\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"move\",\n        \"fileId\": {\n          \"__rl\": true,\n          \"value\": \"={{ $('List Files').item.json.id }}\",\n          \"mode\": \"id\"\n        },\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\"\n        },\n        \"folderId\": {\n          \"__rl\": true,\n          \"value\": \"19cGASY6TsytZwJX9gloRQ0y-HJbUvaFY\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Error\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/19cGASY6TsytZwJX9gloRQ0y-HJbUvaFY\"\n        }\n      },\n      \"id\": \"570960f1-8dd3-4d9d-bb0a-137ba940d00b\",\n      \"name\": \"Error Handling\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"typeVersion\": 3,\n      \"position\": [\n        4160,\n        2000\n      ],\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"wdsP0R2suhB5uk31\",\n          \"name\": \"Google Drive H&F\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"value\": \"={{ $item(2).$node[\\\"AI_Variables\\\"].json[\\\"ActualModel\\\"] }}\",\n          \"mode\": \"id\"\n        },\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"={{ $item(2).$node[\\\"AI_Variables\\\"].json[\\\"SystemPrompt\\\"] }}\",\n              \"role\": \"system\"\n            },\n            {\n              \"content\": \"={{ $item(2).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_1\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(2).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_2\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(2).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_3\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(2).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_4\\\"] }}\"\n            },\n            {\n              \"content\": \"=# Knowledge\\n### Invoice Description \\n{{ $json.InvoiceDescription.Description }}\\n\\n### Invoice information and data:\\n{{ JSON.stringify($('Invoice Data').item.json.choices[0].message.content) }}\\n\\n### Provided Accounts from PUC:\\n{{ JSON.stringify($('Agregador Parm Terceros').item.json.data[0]) }}\\n\\n\\n### Expense Type:\\n{{ $json.InvoiceDescription.ExpenseType }}\"\n            }\n          ]\n        },\n        \"simplify\": false,\n        \"jsonOutput\": true,\n        \"options\": {\n          \"maxTokens\": 4096,\n          \"temperature\": \"={{ $item(2).$node[\\\"AI_Variables\\\"].json[\\\"Temperature\\\"] }}\"\n        }\n      },\n      \"id\": \"f2b681de-ad37-4bcf-b4e8-da442207e946\",\n      \"name\": \"Account_Classification\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"typeVersion\": 1.4,\n      \"position\": [\n        4100,\n        1060\n      ],\n      \"alwaysOutputData\": true,\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"0r1L7QIDC5ZRtM0r\",\n          \"name\": \"OpenAi\"\n        }\n      },\n      \"onError\": \"continueErrorOutput\"\n    },\n    {\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"id\": \"41cf0049-d022-4955-9db2-e1622b5f3b21\",\n      \"name\": \"Loop Over Items1\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"typeVersion\": 3,\n      \"position\": [\n        180,\n        1700\n      ]\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"b5db9061-d7ff-4482-98f9-f0c3ac0c4a18\",\n              \"name\": \"choices[0].message.content\",\n              \"value\": \"={{ $json.data[0] }}\",\n              \"type\": \"object\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"84b293ae-7d61-4294-b257-3b81cfddec74\",\n      \"name\": \"Items Data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        -2760,\n        1720\n      ],\n      \"executeOnce\": true\n    },\n    {\n      \"parameters\": {\n        \"aggregate\": \"aggregateAllItemData\",\n        \"options\": {}\n      },\n      \"id\": \"8df3a292-7f41-428d-a927-96a9e6368bca\",\n      \"name\": \"Aggregate\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -500,\n        1700\n      ]\n    },\n    {\n      \"parameters\": {},\n      \"id\": \"8e23e614-b150-491a-a171-92d0005e5dfe\",\n      \"name\": \"Replace Me1\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -400,\n        1060\n      ]\n    },\n    {\n      \"parameters\": {\n        \"fieldToSplitOut\": \"Items\",\n        \"include\": \"allOtherFields\",\n        \"options\": {}\n      },\n      \"id\": \"bdd05113-ec2f-47cb-93a6-97a5edb69596\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -100,\n        1700\n      ]\n    },\n    {\n      \"parameters\": {},\n      \"id\": \"4a0f666d-67df-4346-a370-bae4152d7861\",\n      \"name\": \"Replace Me2\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -400,\n        1260\n      ]\n    },\n    {\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"value\": \"={{ $item(1).$node[\\\"AI_Variables\\\"].json[\\\"ActualModel\\\"] }}\",\n          \"mode\": \"id\"\n        },\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"={{ $item(1).$node[\\\"AI_Variables\\\"].json[\\\"SystemPrompt\\\"] }}\",\n              \"role\": \"system\"\n            },\n            {\n              \"content\": \"={{ $item(1).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_1\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(1).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_2\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(1).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_3\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(1).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_4\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ JSON.stringify($('Invoice Data').item.json.choices[0].message.content) }}\"\n            }\n          ]\n        },\n        \"simplify\": false,\n        \"jsonOutput\": true,\n        \"options\": {\n          \"maxTokens\": 4096,\n          \"temperature\": \"={{ $item(1).$node[\\\"AI_Variables\\\"].json[\\\"Temperature\\\"] }}\"\n        }\n      },\n      \"id\": \"255f3d59-60b8-4c2a-81ee-f00723342d89\",\n      \"name\": \"Invoice Description\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"typeVersion\": 1.4,\n      \"position\": [\n        -1604,\n        1282\n      ],\n      \"alwaysOutputData\": true,\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"0r1L7QIDC5ZRtM0r\",\n          \"name\": \"OpenAi\"\n        }\n      },\n      \"onError\": \"continueErrorOutput\"\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"8b565e93-0a7f-47f7-a8f1-4be3d0e53e79\",\n              \"name\": \"Description\",\n              \"value\": \"={{ $json.Items.Description }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"b725ac85-a5d3-4c76-93cd-96d620eb8be1\",\n              \"name\": \"Quantity\",\n              \"value\": \"={{ $json.Items.Quantity }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"c8b2252d-e993-4302-b8f7-fd101a0c5697\",\n              \"name\": \"Unit_Value\",\n              \"value\": \"={{ $json.Items.Unit_Value }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"6944de35-3853-4574-91e5-0d5ac8ec3a94\",\n              \"name\": \"Total_Value\",\n              \"value\": \"={{ $json.Items.Total_Value }}\",\n              \"type\": \"string\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"6afb950a-3af8-4173-9baf-4b943a8fe79e\",\n      \"name\": \"Edit Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        400,\n        1780\n      ],\n      \"notesInFlow\": true,\n      \"notes\": \"Prepara toda los items de la factura para clasificar por Producto o Servicio\"\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"b5db9061-d7ff-4482-98f9-f0c3ac0c4a18\",\n              \"name\": \"Items\",\n              \"value\": \"={{ $json.data[1].choices[0].message.content }}\",\n              \"type\": \"object\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"3d56055d-2b2d-4979-a81b-8491fce754e2\",\n      \"name\": \"Items Data 2\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        -300,\n        1700\n      ],\n      \"executeOnce\": true,\n      \"notesInFlow\": true,\n      \"notes\": \"Prepara toda los items de la factura para liquidar ReteFuente\"\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"348460da-c489-4d37-b6eb-5a84d4f55464\",\n              \"name\": \"Description\",\n              \"value\": \"={{ $('Edit Fields').item.json.Description }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"eb5b5f0a-73fb-4d0c-922e-3fb69411fb63\",\n              \"name\": \"Quantity\",\n              \"value\": \"={{ $('Edit Fields').item.json.Quantity }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"01edaea9-14dd-4955-9dd2-5c321683b4dc\",\n              \"name\": \"Unit_Value\",\n              \"value\": \"={{ $('Edit Fields').item.json.Unit_Value }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"8666c88d-d41c-48f2-bbf2-07e99771e07c\",\n              \"name\": \"Total_Value\",\n              \"value\": \"={{ $('Edit Fields').item.json.Total_Value }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"e9a1cc88-09dd-42e6-b401-ce8c3cc89953\",\n              \"name\": \"ExpenseType\",\n              \"value\": \"={{ $json.choices[0].message.content.ExpenseType }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"4cd0f626-8973-4024-9f79-27dd1a9483ed\",\n              \"name\": \"Detalle\",\n              \"value\": \"={{ $json.choices[0].message.content.Detalle }}\",\n              \"type\": \"string\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"8db75461-3d89-4f88-98e9-02301f44a56a\",\n      \"name\": \"Items Expense Type\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        1780,\n        1800\n      ],\n      \"notesInFlow\": true,\n      \"notes\": \"Item de la factura clasificado por Producto o Servicio\"\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"6f3248dc-b292-4273-8442-8f6aa7d8a118\",\n              \"name\": \"Description\",\n              \"value\": \"={{ $json.Description }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"df419e2f-9ee9-49d5-8076-8d570f624a33\",\n              \"name\": \"Quantity\",\n              \"value\": \"={{ $json.Quantity }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"65e07cec-1831-493a-8f90-8a007bd2966a\",\n              \"name\": \"Unit_Value\",\n              \"value\": \"={{ $json.Unit_Value }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"8b99c7f9-9bd9-4296-b945-8f2020c8f793\",\n              \"name\": \"Total_Value\",\n              \"value\": \"={{ $json.Total_Value }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"9da05c52-8c1c-403a-a0b5-f4138c070a73\",\n              \"name\": \"ExpenseType\",\n              \"value\": \"={{ $json.ExpenseType }}\",\n              \"type\": \"string\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"d2d1ea73-ed31-413f-8e65-8717a58ee410\",\n      \"name\": \"Items Expense Type 2\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        400,\n        1620\n      ],\n      \"notesInFlow\": true,\n      \"alwaysOutputData\": true,\n      \"notes\": \"Item de la factura clasificado por Producto o Servicio\"\n    },\n    {\n      \"parameters\": {},\n      \"id\": \"c4d9339b-28f8-47aa-afe0-921b821ea7ee\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"typeVersion\": 3,\n      \"position\": [\n        -880,\n        1700\n      ]\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"getAll\",\n        \"tableId\": \"Retefuente_TAX\",\n        \"returnAll\": true,\n        \"filterType\": \"none\"\n      },\n      \"id\": \"3b9255b2-478a-4f6a-b400-fd974b03ffdb\",\n      \"name\": \"Tablas ReteFuente\",\n      \"type\": \"n8n-nodes-base.supabase\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -6060,\n        1660\n      ],\n      \"alwaysOutputData\": true,\n      \"executeOnce\": true,\n      \"credentials\": {\n        \"supabaseApi\": {\n          \"id\": \"U4Lx0acH9rOsOwsN\",\n          \"name\": \"Supabase InvoiceData\"\n        }\n      },\n      \"notes\": \"Parametrización Retención en la Fuente\"\n    },\n    {\n      \"parameters\": {\n        \"aggregate\": \"aggregateAllItemData\",\n        \"options\": {}\n      },\n      \"id\": \"298dbff7-ba9e-49ef-a040-a12f5c05b7e4\",\n      \"name\": \"Parametrizacion ReteFuente\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -5840,\n        1660\n      ],\n      \"executeOnce\": false\n    },\n    {\n      \"parameters\": {\n        \"operation\": \"getAll\",\n        \"tableId\": \"ReteICA_TAX\",\n        \"returnAll\": true,\n        \"filterType\": \"none\"\n      },\n      \"id\": \"edb43d9b-4c81-4b5f-baab-d90c84aa812d\",\n      \"name\": \"Tabla ICA\",\n      \"type\": \"n8n-nodes-base.supabase\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -5400,\n        1660\n      ],\n      \"alwaysOutputData\": true,\n      \"executeOnce\": true,\n      \"credentials\": {\n        \"supabaseApi\": {\n          \"id\": \"U4Lx0acH9rOsOwsN\",\n          \"name\": \"Supabase InvoiceData\"\n        }\n      },\n      \"notes\": \"Parametrización ICA\"\n    },\n    {\n      \"parameters\": {\n        \"aggregate\": \"aggregateAllItemData\",\n        \"options\": {}\n      },\n      \"id\": \"46f631e4-2578-43ac-adb2-34521a3561b7\",\n      \"name\": \"Parametrizacion ICA\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -5180,\n        1660\n      ],\n      \"executeOnce\": false\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"aaf1aed6-347b-4119-a406-9c3f6dab2339\",\n              \"name\": \"Parametros ReteFuente\",\n              \"value\": \"={{ $json.data }}\",\n              \"type\": \"array\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"7aafd84d-344f-4aaf-88f2-58e443f53d60\",\n      \"name\": \"Parametros ReteFuente\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        -5620,\n        1660\n      ],\n      \"executeOnce\": true\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"257e7136-3b65-4f7d-b7a5-7bdbe3e21153\",\n              \"name\": \"Parametros ICA\",\n              \"value\": \"={{ $json.data }}\",\n              \"type\": \"array\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"id\": \"cc012d4c-1dd5-4625-aec6-8066a0312d31\",\n      \"name\": \"Parametros ICA\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        -4960,\n        1660\n      ]\n    },\n    {\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"conditions\": {\n                \"options\": {\n                  \"caseSensitive\": true,\n                  \"leftValue\": \"\",\n                  \"typeValidation\": \"loose\",\n                  \"version\": 2\n                },\n                \"conditions\": [\n                  {\n                    \"leftValue\": \"={{ $json.data[0].ReceiverParty_TaxLevelCode }}\",\n                    \"rightValue\": \"O-15\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    }\n                  }\n                ],\n                \"combinator\": \"and\"\n              },\n              \"renameOutput\": true,\n              \"outputKey\": \"Autorretenedor\"\n            },\n            {\n              \"conditions\": {\n                \"options\": {\n                  \"caseSensitive\": true,\n                  \"leftValue\": \"\",\n                  \"typeValidation\": \"loose\",\n                  \"version\": 2\n                },\n                \"conditions\": [\n                  {\n                    \"id\": \"d7bfd2a6-fa85-4277-ac37-b1a6594f4956\",\n                    \"leftValue\": \"={{ $json.data[0].ReceiverParty_TaxLevelCode }}\",\n                    \"rightValue\": \"O-12\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\",\n                      \"name\": \"filter.operator.equals\"\n                    }\n                  }\n                ],\n                \"combinator\": \"and\"\n              },\n              \"renameOutput\": true,\n              \"outputKey\": \"R. Simplificado\"\n            }\n          ]\n        },\n        \"looseTypeValidation\": true,\n        \"options\": {\n          \"fallbackOutput\": \"extra\",\n          \"allMatchingOutputs\": true\n        }\n      },\n      \"id\": \"de515858-1821-43bd-8176-2d592c58e753\",\n      \"name\": \"Switch\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"typeVersion\": 3.2,\n      \"position\": [\n        -400,\n        1440\n      ],\n      \"executeOnce\": true,\n      \"notesInFlow\": true,\n      \"notes\": \"Clasificación según Responsabilidad Fiscal\"\n    },\n    {\n      \"parameters\": {\n        \"aggregate\": \"aggregateAllItemData\",\n        \"options\": {}\n      },\n      \"id\": \"ce766eba-4e26-45d0-94d6-c3eb58a8a4ee\",\n      \"name\": \"Aggregate1\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"typeVersion\": 1,\n      \"position\": [\n        1040,\n        1580\n      ]\n    },\n    {\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"value\": \"={{ $item(3).$node[\\\"AI_Variables\\\"].json[\\\"ActualModel\\\"] }}\",\n          \"mode\": \"id\"\n        },\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"={{ $item(3).$node[\\\"AI_Variables\\\"].json[\\\"SystemPrompt\\\"] }}\",\n              \"role\": \"system\"\n            },\n            {\n              \"content\": \"={{ $item(3).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_1\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(3).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_2\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(3).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_3\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(3).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_4\\\"] }}\"\n            },\n            {\n              \"content\": \"=Item Description\\n{{ $json.Description }}\"\n            }\n          ]\n        },\n        \"simplify\": false,\n        \"jsonOutput\": true,\n        \"options\": {\n          \"maxTokens\": 4096,\n          \"temperature\": \"={{ $item(3).$node[\\\"AI_Variables\\\"].json[\\\"Temperature\\\"] }}\"\n        }\n      },\n      \"id\": \"ea352dd8-3954-4feb-83c5-195f327e5d06\",\n      \"name\": \"Invoice Description1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"typeVersion\": 1.4,\n      \"position\": [\n        620,\n        1780\n      ],\n      \"alwaysOutputData\": true,\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"0r1L7QIDC5ZRtM0r\",\n          \"name\": \"OpenAi\"\n        }\n      },\n      \"onError\": \"continueErrorOutput\"\n    },\n    {\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"value\": \"={{ $item(4).$node[\\\"AI_Variables\\\"].json[\\\"ActualModel\\\"] }}\",\n          \"mode\": \"id\"\n        },\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"={{ $item(4).$node[\\\"AI_Variables\\\"].json[\\\"SystemPrompt\\\"] }}\",\n              \"role\": \"system\"\n            },\n            {\n              \"content\": \"={{ $item(4).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_1\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(4).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_2\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(4).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_3\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(4).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_3\\\"] }}\"\n            },\n            {\n              \"content\": \"={{ $item(4).$node[\\\"AI_Variables\\\"].json[\\\"UserPrompt_4\\\"] }}\"\n            }\n          ]\n        },\n        \"simplify\": false,\n        \"jsonOutput\": true,\n        \"options\": {\n          \"maxTokens\": 4096,\n          \"temperature\": \"={{ $item(4).$node[\\\"AI_Variables\\\"].json[\\\"Temperature\\\"] }}\"\n        }\n      },\n      \"id\": \"ff87901c-2bfb-4ee4-834c-eec3951b24c8\",\n      \"name\": \"Invoice_Type\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"typeVersion\": 1.4,\n      \"position\": [\n        840,\n        1680\n      ],\n      \"alwaysOutputData\": true,\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"0r1L7QIDC5ZRtM0r\",\n          \"name\": \"OpenAi\"\n        }\n      },\n      \"onError\": \"continueErrorOutput\"\n    }\n  ],\n  \"connections\": {\n    \"XML Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"XML\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Files / XML\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"XML Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Drive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"InvoiceDB\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Google Drive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error Log  5\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error Log 2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Error Handling\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"All_Invoice_Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prepare Data for DB\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Prepare Data for DB\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Model Test\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error Log  4\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error Log  3\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Error Handling\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error Log  4\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Error Handling\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error Log  5\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Error Handling\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error Log \": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Error Handling\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Model Test\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"XML\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract XML Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Extract Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract XML Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Agregador DataXML\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error Log \",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Tablas ReteFuente\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"List Files\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Files / XML\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"VendorAccounts\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Clean JSON\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error Log 1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Agregador DataXML\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Invoice Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Agregador Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error Log \",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Agregador Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Items Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Invoice Description\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error Log 1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Invoice Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"VendorAccounts\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Clean JSON\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Agregador Parm Terceros\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI_Variables\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"List Files\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Agregador Parm Terceros\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Description\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Data_XML_Invoice\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Data_XML_Invoice\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Format_XMLInvoice_Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Format_XMLInvoice_Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error Handling\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Account_Classification\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"All_Invoice_Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error Log  3\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Items Expense Type 2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Edit Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Items Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Aggregate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Invoice Description\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Description\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error Log 2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Items Data 2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Tablas ReteFuente\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parametrizacion ReteFuente\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parametrizacion ReteFuente\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parametros ReteFuente\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Tabla ICA\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parametrizacion ICA\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parametrizacion ICA\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parametros ICA\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parametros ReteFuente\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Tabla ICA\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parametros ICA\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI_Variables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Invoice Description1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Items Expense Type\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Replace Me1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Replace Me2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Items Data 2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Items Expense Type\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Invoice Description1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Invoice_Type\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Invoice_Type\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  },\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"staticData\": null,\n  \"meta\": {\n    \"templateCredsSetupCompleted\": true\n  },\n  \"pinData\": {},\n  \"versionId\": \"12ce5dd4-35d9-4f6d-a909-8fe1a609ae7e\",\n  \"triggerCount\": 0,\n  \"tags\": []\n}"
}